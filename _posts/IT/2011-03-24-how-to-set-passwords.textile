---
layout: horizontal
title: 秘密的公開與公開的秘密
tags:
- 亂彈
- 電腦
categories: 網誌
date: 2011/03/24 03:52:40
---
前段時間，我一個小站所在的主機被黑了。黑客把 MySQL 的帳號改了，並在根目錄下加了一個 index.htm ，於是訪問時會看見他的頁面說這個站被黑了。刪掉他的 index.htm，主頁變成了文件詳目，並且可以免登入修改和刪除。我到主題所在目錄下刪掉幾個文件，就沒事了。
空間是 hostloc 上組長贊助的，那天我上 hostloc ，就看到有人發帖說自己網站被黑了。說明這是大面積侵入，與個人設置無關。
這是我首度被成功的黑客影響。
這件事並沒有太多負面影響，而且事件本身屬於漏洞被利用的問題，而非密碼不妥，但我卻想到了密碼安全問題（最近老媽說要網上炒股也是一個誘因），所以今天來談一談密碼設置的藝術與技術。

h2. 弱口令

很久以前，我看到一篇文章，上面統計了美國十大常見密碼，譬如 123456, password, iloveyou 。恰好中文系某位老師就喜歡十大密碼之一，而 D 老闆的實驗室中，所有學生的帳號，密碼都是 password 。又聞中國網上炒股炒出問題的，大抵都是沒裝防火牆，又喜歡以 123456 為密碼的。十大密碼是最爛的密碼，與其說是密碼保護了使用者，不如說是用戶名保護呢！
現在也很流行蹭網卡，其實就是一個無線網卡，裏面配上一個破解軟件。這破解軟件之中，往往有一個密碼庫，裏面羅列了數以萬計的常見密碼。我下載了一些常見弱口令字典，其構成無外乎以下幾種：
按順序羅列數字，如 123456
生日、紀念日、電話號碼等，如 10012011
字母重複，如 aaaaaa 或 aaabbbccc
英文單詞、英文名
短英文單詞組合，如 fuckyou
雙拼，如 diannao
順序數字 + 字母，如 abc123
著名數字或英數組合，如 ncc1701, 8675309
鍵盤手順，如 1234qwer 或 asdfghjkl 或 !@#$%^&amp;*() 或qazwsx
如果你的密碼不幸在弱口令列表之中，那麼黑客破解他需要的時間大概就是一秒吧。這顯然是非常不安全的，所以才有蹩腳的中國三流黑客大量破解股民帳戶的事情，因為密碼太好猜了。

h2. 複雜密碼與隨機密碼

忘記密碼的時候，一般可以要求郵箱重設什麼的，這時候經常是系統提供一個隨機密碼。
應該說，隨機密碼是最強的密碼，因為你不可能用社會工程學破解他，只能費力的一個一個去試。
可是隨機密碼真的很不好記，所以有的人在記事本裏面粘上他的隨機密碼，需要時複製粘貼就好——可是萬一電腦中毒了呢？
所以還是複雜密碼比較好。一般的，複雜密碼包含英文字母、數字、半角符號三大要素，不過就算少掉符號，也還算是複雜密碼。在某些網站註冊的時候，符合英數皆有這一條件的，因為安全度高一些。不過複雜密碼究竟如何想出來，還要等會再說。

h2. 弱口令的改造

弱口令是有他的意義的：普遍上來講，非常好記。對於具有共享性質的密碼，我們可以使用弱口令，但為了增加安全系數，又不妨改造一下。
想當年，我在三中的時候，很多老師的郵箱密碼是 123456 ，大家也都知道這回事，因為每次月考看成績和排名都需要用到。不過後來有些老師就不樂意了，不希望隨便什麼班級的人都看他的郵箱，於是反了過來，改成 654321 ，雖然還是弱口令，總是比先前那個難猜許多。
又或者 drowssap ，只不過把 password 倒過來，就不在常見弱口令字典之中了。如果再改成 ssapdrow ，那還真不好猜。
這就是典型的弱口令改造。
我們繼續改造。
D 老闆實驗室中的電腦， root 密碼就不是 password 了。我看博士生輸入，看出來是個 alabama5353 。 alabama 是典型的弱口令， 5353 也是，但二者結合就不是弱口令了。
我曾經在中文系使用過一條公開的密碼 hssdoc2006 ， hss 是人文學院的簡稱， doc 是中文系的簡稱， 2006 是我們這一級。這個密碼不是弱口令，但是如果瞭解中文系的社會工程學，這就是弱口令。
我還很喜歡用一種弱口令：不存在的動詞時態或名詞複數形式。比如說， went 明明是過去式，我卻在後面加上 ing ，這太不社會工程學了，應該不在弱口令字典當中。又或者 data 是一個名詞的複數形式，我在後面加上 es ，那就是不存在的詞。
改造過的弱口令雖然還是比較弱的，但弱與強，好記與難記得到了協調，用在不重要的場合或半公開場合倒也不錯。

h2. 密碼表

密碼表不是弱口令字典，而是將密碼明文轉換為密文或反之的東西，最早應用於軍事，不過現在到處都在用，我們也不妨借鑒借鑒。
看到這裡，讀者大概還不大明白什麼是密碼表，那我舉一個最簡單的吧。凱撒密碼表：
A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
T U V W X Y Z A B C D E F G H I J K L M N O P Q R S
也就是說， A 被 T 代表了， B 被 U 代表了……假設我們來加密一段明文：
明文：THE FAULT, DEAR BRUTUS, LIES NOT IN OUR STARS BUT IN OURSELVES.
密文：MAX YTNEM, WXTK UKNMNL, EBXL GHM BG HNK LMTKL UNM BG HNKLXEOXL.
當然啦，這個密碼表古老、過時又傻叉。因為如果密文長一點，拿個字頻表就搞定了。記得在愛倫坡的怪異故事集裏面有一則破解海盜基德的密碼的，海盜用符號代替字母，還是被主人公勒讓德快速破解了。
我們來升級一下，佛吉尼亞密碼表：
A A B C D E F G H I J K L M N O P Q R S T U V W X Y Z 
B B C D E F G H I J K L M N O P Q R S T U V W X Y Z A 
C C D E F G H I J K L M N O P Q R S T U V W X Y Z A B 
D D E F G H I J K L M N O P Q R S T U V W X Y Z A B C 
E E F G H I J K L M N O P Q R S T U V W X Y Z A B C D 
F F G H I J K L M N O P Q R S T U V W X Y Z A B C D E 
G G H I J K L M N O P Q R S T U V W X Y Z A B C D E F 
H H I J K L M N O P Q R S T U V W X Y Z A B C D E F G 
I I J K L M N O P Q R S T U V W X Y Z A B C D E F G H 
J J K L M N O P Q R S T U V W X Y Z A B C D E F G H I 
K K L M N O P Q R S T U V W X Y Z A B C D E F G H I J 
L L M N O P Q R S T U V W X Y Z A B C D E F G H I J K 
M M N O P Q R S T U V W X Y Z A B C D E F G H I J K L 
N N O P Q R S T U V W X Y Z A B C D E F G H I J K L M 
O O P Q R S T U V W X Y Z A B C D E F G H I J K L M N 
P P Q R S T U V W X Y Z A B C D E F G H I J K L M N O 
Q Q R S T U V W X Y Z A B C D E F G H I J K L M N O P 
R R S T U V W X Y Z A B C D E F G H I J K L M N O P Q 
S S T U V W X Y Z A B C D E F G H I J K L M N O P Q R 
T T U V W X Y Z A B C D E F G H I J K L M N O P Q R S 
U U V W X Y Z A B C D E F G H I J K L M N O P Q R S T 
V V W X Y Z A B C D E F G H I J K L M N O P Q R S T U 
W W X Y Z A B C D E F G H I J K L M N O P Q R S T U V 
X X Y Z A B C D E F G H I J K L M N O P Q R S T U V W 
Y Y Z A B C D E F G H I J K L M N O P Q R S T U V W X 
Z Z A B C D E F G H I J K L M N O P Q R S T U V W X Y
佛吉尼亞密碼表的偉大之處在於密鑰。密鑰是一句話，當他指向某個字母時，我們要查那一行作為密碼表。比如說密鑰是 relations ：
密钥： RELATIONSRELATIONSRELATIONSREL
明文： TO BE OR NOT TO BE THAT IS THE QUESTION
密文： KS ME HZ BBL KS ME MPOG AJ XSE JCSFLZSY
如果海盜基德用這種方法，勒讓德就挖不到寶藏了。二戰時代的密碼基本上都是佛吉尼亞密碼的威力加強版，不知道現在又是如何？反正佛吉尼亞的已經夠恐怖了。對於這樣的密文，我們完全不怕被截獲，因為截獲了也沒用。所以那時候電報就是這麼發，你愛截不截，截了也沒用，因為你沒有密鑰和密碼表。最近中國特別喜歡放二戰間諜片（比如曾經紅極一時的人間正道是滄桑，還有最近很紅的旗袍），間諜們若是偷得到密碼表和密鑰，那纔叫厲害呢。
假設我們用佛吉尼亞密碼表，然後自己想一個密鑰，每註冊一個帳號，就把用戶名當明文，密碼當密文，那黑客也只好一個一個試下去了。
現在還有一種非常常見的加密方式，叫 md5 加密。無論多長的密碼，根據 md5 的算法，都會算出一串 32 位的數字來。讓人覺得神秘的是，只要用這個算法，相同的密碼怎麼算都是一個 md5 值。這個計算過程是不可逆的，一般用於密碼保護。類似的，還有 sha1 之類，不一而足。不過雖說 md5 是不可逆的，但我們可以比對啊。比如 123456 用 md5 加密之後就是 e10adc3949ba59abbe56e057f20f883e ，只要你記得 e10adc3949ba59abbe56e057f20f883e 就是 123456 就不愁啦。現在很多網站都在做 md5 解密，就是利用一個龐大的 md5 資料庫來提供服務的。我試著把 e10adc3949ba59abbe56e057f20f883e 給他們解，確實解出來了。
密碼是多種多樣的，然而中文由於同音字組的局限，弱口令的密集程度會比英文還高，該怎麼辦呢？

h2. 中文環境中的密碼

在天龍八部中，金庸寫到，慕容家有一種特殊的密碼，寫出來的信王語嫣都看不懂，不記得是阿朱還是阿碧還是包不同說，這個密碼的原理其實是韻部轉嫁，比如一東轉二冬什麼的。這個密碼其實還是凱撒密碼，只不過中文不是字母文字，破解者無法通過統計字頻的方式破譯。不過如果統計「韻頻」的話，可能可以破解哦。
據說在抗戰時期，中國有一套神奇的密碼，是日軍一開始措手不及，無法破解的。而且這套密碼編譯和解析過程非常快，快到大概幾秒鐘一句話吧（如果讀者嘗試編譯了凱撒或佛吉尼亞密碼的，一定會大讚這效率的）。怎麼會有如此高效的密碼咧？其實這不是密碼，而是方言。這個方言因為和普通話差得太遠，簡直就是另一種語言，所以沒法破譯（不過我對此存疑，因為七大方言除了閩語都是中古一系，沒什麼特別難懂的）。所以，使用別人不懂的一門語言，是一種非常好的密碼。我們從此得到啟發：拼音密碼太過簡單了，何不嘗試方言拼音密碼呢？
其實就算拼音密碼，也是可以從弱口令變強的。據我觀察，弱口令字典裏面並沒有加了聲調的雙拼，換言之，如果拼音密碼加上了聲調，就不是弱口令了。這絕對比很多人的拼音加生日或拼音加 123 要好。

h2. 我的密碼

我的密碼沒有一個在弱口令字典裏面，但是有兩個常用密碼和弱口令字典裏的相似度高達 99% 。
另外有一個十位的密碼，做測試從來都是 100% very strong 的。我來公開一下這個秘密好了：這個密碼其實在本站首頁就可以看到，只不過根據某個非常非常非常常用的密碼表進行了編譯。具體註冊網站的時候，用密碼+以域名為明文的密文。